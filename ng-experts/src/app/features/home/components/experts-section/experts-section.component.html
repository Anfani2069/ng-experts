<!-- EXPERTS SECTION (BG NOIR NOIR #000000 - SANS BRUIT DE FOND) -->
<section id="experts" class="bg-expertSectionBg py-6 min-h-screen">
  <div class="container mx-auto px-10 md:px-20 max-w-7xl text-center">
    <div class="mb-8 flex flex-col items-center">
      <div class="flex items-center gap-2 text-subtext text-[10px] font-bold uppercase tracking-widest mb-4">
        <i class="fa-solid fa-star text-primary"></i> Best Angular Experts
      </div>
      <!-- Search & Filters -->
      <div class="w-full max-w-4xl space-y-6">
        <!-- Champs de recherche -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-white mb-2">Ville</label>
            <div class="relative">
              <i class="fa-solid fa-location-dot absolute left-5 top-1/2 -translate-y-1/2 text-subtext text-sm"></i>
              <input type="text" placeholder="Paris, Lyon..." [value]="cityFilter()" (input)="onCityFilterChange($event)"
                class="w-full bg-transparent border border-border rounded-full pl-12 pr-4 py-3 text-sm focus:outline-none focus:border-white/20 transition text-white placeholder:text-subtext">
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-white mb-2">Technologie</label>
            <div class="relative">
              <i class="fa-solid fa-code absolute left-5 top-1/2 -translate-y-1/2 text-subtext text-sm"></i>
              <input type="text" placeholder="Vue.js, Python..." [value]="techFilter()" (input)="onTechFilterChange($event)"
                class="w-full bg-transparent border border-border rounded-full pl-12 pr-4 py-3 text-sm focus:outline-none focus:border-white/20 transition text-white placeholder:text-subtext">
            </div>
          </div>
        </div>

        <!-- Pills de disponibilité -->
        <div>
          <div class="flex flex-wrap justify-center gap-2">
            @for (type of availabilityTypes; track type.value) {
            <button
              type="button"
              (click)="toggleAvailabilityType(type.value)"
              [class]="getAvailabilityButtonClass(type.value)"
              class="px-5 py-2.5 rounded-full text-sm font-semibold transition-all border"
            >
              {{ type.label }}
            </button>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- État de chargement -->
    @if (isLoading()) {
    <div class="max-w-4xl mx-auto space-y-4">
      @for (skeleton of [1,2,3]; track skeleton) {
      <div class="expert-card p-6 rounded-2xl flex flex-col md:flex-row items-center gap-6 animate-pulse">
        <div class="w-16 h-16 rounded-2xl bg-white/5 shrink-0"></div>
        <div class="flex-grow space-y-3 w-full">
          <div class="h-5 bg-white/5 rounded w-1/3"></div>
          <div class="h-4 bg-white/5 rounded w-1/4"></div>
          <div class="h-3 bg-white/5 rounded w-1/2 pt-2"></div>
        </div>
      </div>
      }
    </div>
    }

    <!-- Message d'erreur -->
    @if (error() && !isLoading()) {
    <div class="max-w-2xl mx-auto text-center py-12">
      <div class="bg-red-900/10 border border-red-500/20 rounded-2xl p-8">
        <i class="fa-solid fa-triangle-exclamation text-red-500 text-4xl mb-4"></i>
        <h3 class="text-xl font-bold text-white mb-2">Erreur de chargement</h3>
        <p class="text-subtext mb-6">{{ error() }}</p>
        <button (click)="ngOnInit()"
          class="bg-red-600 hover:bg-[#C0266B] text-white px-8 py-3 rounded-full font-bold uppercase tracking-widest text-[11px] transition-all">
          Réessayer
        </button>
      </div>
    </div>
    }

    <!-- LISTE DES CARTES (LES CARTES ONT DU BRUIT) -->
    @if (!isLoading() && !error()) {
    <div class="max-w-4xl mx-auto space-y-4 text-left">
      @for (expert of filteredExperts(); track expert.id) {
      <div (click)="onHireExpert(expert.id)"
        class="expert-card p-6 rounded-2xl flex items-center gap-6 group cursor-pointer border-white/5 transition-colors relative"
        style="background-color: #222222;">
        <!-- Noise inside card only -->
        <div class="noise-overlay opacity-20"></div>

        <!-- Photo carrée plus petite -->
        <div class="relative z-10 flex-shrink-0">
          <img [src]="expert.avatar"
            class="w-16 h-16 rounded-xl border border-white/10 group-hover:scale-105 transition-transform object-cover"
            [alt]="getFullName(expert)">
          @if (expert.isAvailable) {
          <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-[#222222]">
          </div>
          }
        </div>

        <!-- Contenu principal -->
        <div class="flex-grow relative z-10">
          <!-- En-tête avec titre -->
          <div class="flex items-start justify-between mb-3">
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-1">
                <h3 class="text-xl font-bold text-white group-hover:text-primary transition-colors">{{ getFullName(expert) }}</h3>
                @if (expert.verificationStatus === 'verified') {
                <span class="text-[10px] text-blue-400 font-bold uppercase tracking-widest border border-blue-400/20 px-2 py-0.5 rounded-md bg-blue-400/10">VERIFIED</span>
                }
              </div>
              <p class="text-subtext text-sm">
                {{ expert.company || 'Independent' }}
              </p>
            </div>

            <!-- Bookmark uniquement -->
            <button
              type="button"
              (click)="toggleFavorite(expert.id, $event)"
              class="relative z-20 text-subtext hover:text-white transition-colors"
              title="Ajouter aux favoris"
            >
              <i class="fa-regular fa-bookmark text-lg"></i>
            </button>
          </div>

          <!-- Ligne d'infos principale -->
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3 text-sm text-subtext">
              <span>{{ expert.city }}</span>
              <span>|</span>
              <span>Full Time</span>
              <span>|</span>
              <span class="capitalize">{{ formatWorkPreference(expert.availability.workPreference) }}</span>
              <span>|</span>
              <span class="text-white font-semibold">{{ expert.availability.dailyRate }}/ Jour</span>
            </div>

            <!-- Flèche avec animation -->
            <span class="text-white group-hover:text-primary transition-all duration-300">
              <i class="fa-solid fa-arrow-right-long text-xl -rotate-45 group-hover:rotate-0 transition-transform"></i>
            </span>
          </div>
        </div>
      </div>
      }

      @if (filteredExperts().length === 0) {
      <div class="text-center py-20 bg-surface/30 rounded-3xl border border-white/5">
        <i class="fa-solid fa-users-slash text-gray-700 text-5xl mb-4"></i>
        <h3 class="text-xl font-bold text-white mb-2">Aucun expert trouvé</h3>
        <p class="text-subtext mb-8">Essayez de modifier vos critères de recherche.</p>
        <button (click)="resetFilters()"
          class="px-6 py-2.5 bg-white/5 hover:bg-white/10 border border-white/10 text-white rounded-full font-semibold uppercase tracking-widest text-[11px] transition-all">
          Réinitialiser
        </button>
      </div>
      }
    </div>

    <div class="mt-16 text-center">
      <button (click)="onShowAllExperts()"
        class="px-8 py-2.5 bg-primary hover:bg-primary-hover text-white rounded-full font-semibold uppercase tracking-widest text-[11px] shadow-[0_0_20px_-5px_rgba(236,72,153,0.5)] transition-all">
        Show all Experts
      </button>
    </div>
    }
  </div>
</section>
