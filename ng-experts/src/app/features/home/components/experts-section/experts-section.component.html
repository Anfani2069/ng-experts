<!-- EXPERTS SECTION (BG #121212 - AVEC BRUIT DE FOND) -->
<section id="experts" class="relative bg-[#121212] py-6 min-h-screen overflow-hidden">
  <!-- Noise overlay -->
  <div class="noise-overlay opacity-20"></div>

  <div class="container mx-auto px-10 md:px-20 max-w-7xl text-center relative z-10">
    <div class="mb-8 flex flex-col items-center">
      <div class="flex items-center gap-2 text-subtext text-[10px] font-bold uppercase tracking-widest mb-4">
        <i class="fa-solid fa-star text-primary"></i> Best Angular Experts
      </div>
      <!-- Search & Filters -->
      <div class="w-full max-w-4xl space-y-6">
        <!-- Champs de recherche -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-white mb-2">Ville</label>
            <div class="relative">
              <i class="fa-solid fa-location-dot absolute left-5 top-1/2 -translate-y-1/2 text-subtext text-sm"></i>
              <input type="text" placeholder="Paris, Lyon..." [value]="cityFilter()" (input)="onCityFilterChange($event)"
                class="w-full bg-transparent border border-border rounded-full pl-12 pr-4 py-3 text-sm focus:outline-none focus:border-white/20 transition text-white placeholder:text-subtext">
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-white mb-2">Other Skills</label>
            <div class="relative">
              <i class="fa-solid fa-code absolute left-5 top-1/2 -translate-y-1/2 text-subtext text-sm"></i>
              <input type="text" placeholder="Vue.js, Python..." [value]="techFilter()" (input)="onTechFilterChange($event)"
                class="w-full bg-transparent border border-border rounded-full pl-12 pr-4 py-3 text-sm focus:outline-none focus:border-white/20 transition text-white placeholder:text-subtext">
            </div>
          </div>
        </div>

        <!-- Pills de disponibilité -->
        <div>
          <div class="flex flex-wrap justify-center gap-2">
            @for (type of availabilityTypes; track type.value) {
            <button
              type="button"
              (click)="toggleAvailabilityType(type.value)"
              [class]="getAvailabilityButtonClass(type.value)"
              class="px-5 py-2.5 rounded-full text-sm font-semibold transition-all border"
            >
              {{ type.label }}
            </button>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- État de chargement -->
    @if (isLoading()) {
    <div class="max-w-4xl mx-auto space-y-4">
      @for (skeleton of [1,2,3]; track skeleton) {
      <div class="expert-card p-6 rounded-2xl flex flex-col md:flex-row items-center gap-6 animate-pulse">
        <div class="w-16 h-16 rounded-2xl bg-white/5 shrink-0"></div>
        <div class="flex-grow space-y-3 w-full">
          <div class="h-5 bg-white/5 rounded w-1/3"></div>
          <div class="h-4 bg-white/5 rounded w-1/4"></div>
          <div class="h-3 bg-white/5 rounded w-1/2 pt-2"></div>
        </div>
      </div>
      }
    </div>
    }

    <!-- Message d'erreur -->
    @if (error() && !isLoading()) {
    <div class="max-w-2xl mx-auto text-center py-12">
      <div class="bg-red-900/10 border border-red-500/20 rounded-2xl p-8">
        <i class="fa-solid fa-triangle-exclamation text-red-500 text-4xl mb-4"></i>
        <h3 class="text-xl font-bold text-white mb-2">Erreur de chargement</h3>
        <p class="text-subtext mb-6">{{ error() }}</p>
        <button (click)="ngOnInit()"
          class="bg-red-600 hover:bg-[#C0266B] text-white px-8 py-3 rounded-full font-bold uppercase tracking-widest text-[11px] transition-all">
          Réessayer
        </button>
      </div>
    </div>
    }

    <!-- LISTE DES CARTES (DESIGN RECTANGULAIRE HORIZONTAL) -->
    @if (!isLoading() && !error()) {
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 text-left">
      @for (expert of filteredExperts(); track expert.id) {
      <div (click)="onHireExpert(expert.id)"
        class="expert-card p-5 rounded-2xl group cursor-pointer border border-white/5 transition-all hover:border-primary/30 relative overflow-hidden"
        style="background-color: #222222;">
        <!-- Noise inside card only -->
        <div class="noise-overlay opacity-10"></div>

        <!-- En-tête avec photo et badge -->
        <div class="relative z-10 flex items-start justify-between mb-3">
          <div class="flex items-center gap-3">
            <!-- Photo de profil -->
            <div class="relative">
              <img [src]="expert.avatar"
                class="w-14 h-14 rounded-xl border-2 border-white/10 group-hover:border-primary/50 transition-all object-cover"
                [alt]="getFullName(expert)">
              @if (expert.isAvailable) {
              <div class="absolute -bottom-1 -right-1 w-3.5 h-3.5 bg-green-400 rounded-full border-2 border-[#0A0A0A] animate-pulse">
              </div>
              }
            </div>

            <!-- Nom et localisation -->
            <div>
              <h3 class="text-base font-bold text-white group-hover:text-primary transition-colors mb-0.5">
                {{ getFullName(expert) }}
              </h3>
              <p class="text-subtext text-xs flex items-center gap-1">
                <i class="fa-solid fa-location-dot text-[9px]"></i>
                {{ expert.city }}
              </p>
            </div>
          </div>

          <!-- Badge vérifié -->
          @if (expert.verificationStatus === 'verified') {
          <span class="absolute top-1 right-1 px-2.5 py-0.5 text-[8px] font-bold uppercase tracking-widest bg-blue-500/20 text-blue-400 rounded-full border border-blue-500/30">
            VERIFIED
          </span>
          }
        </div>

        <!-- Description / Poste - Hauteur fixe réduite -->
        <div class="relative z-10 mb-2 h-11">
          <p class="text-xs text-white/90 font-medium mb-0.5 line-clamp-1">
            {{ expert.company }}
          </p>
          <p class="text-[13px] text-subtext line-clamp-2 leading-tight">
            {{ expert.bio  }}
          </p>
        </div>

        <!-- Technologies badges - Hauteur fixe réduite -->
        <div class="relative z-10 mb-3 h-16 overflow-hidden">
          <div class="flex flex-wrap gap-1.5">
            @for (skill of getSkillNames(expert).slice(0, 5); track skill) {
            <span class="px-2.5 py-1 text-[9px] font-semibold uppercase tracking-wider bg-white/5 text-white/80 rounded-md border border-white/10 hover:bg-primary/20 hover:border-primary/30 hover:text-white transition-all">
              {{ skill }}
            </span>
            }
            @if (getSkillNames(expert).length > 5) {
            <span class="px-2.5 py-1 text-[9px] font-semibold uppercase tracking-wider bg-white/5 text-subtext rounded-md border border-white/10">
              +{{ getSkillNames(expert).length - 5 }}
            </span>
            }
          </div>
        </div>

        <!-- Séparateur -->
        <div class="relative z-10 w-full h-px bg-white/5 mb-3"></div>

        <!-- Footer avec infos et actions -->
        <div class="relative z-10 flex items-center justify-between">
          <div class="flex items-center gap-3 text-[11px] text-subtext">
            <!-- TJM -->
            <div class="flex items-center gap-1">
              <i class="fa-solid fa-euro-sign text-primary text-[9px]"></i>
              <span class="text-white font-bold">{{ expert.availability.dailyRate }}/j</span>
            </div>

            <!-- Mode de travail -->
            <div class="flex items-center gap-1">
              <i class="fa-solid fa-{{ expert.availability.workPreference === 'remote' ? 'house-laptop' : expert.availability.workPreference === 'onsite' ? 'building' : 'laptop-house' }} text-[9px]"></i>
              <span class="capitalize">{{ formatWorkPreference(expert.availability.workPreference) }}</span>
            </div>
          </div>

          <!-- Bouton bookmark -->
          <button
            type="button"
            (click)="toggleFavorite(expert.id, $event)"
            class="relative z-20 w-7 h-7 flex items-center justify-center rounded-lg bg-white/5 hover:bg-primary/20 border border-white/10 hover:border-primary/30 text-subtext hover:text-primary transition-all"
            title="Ajouter aux favoris"
          >
            <i class="fa-regular fa-bookmark text-xs"></i>
          </button>
        </div>
      </div>
      }

      @if (filteredExperts().length === 0) {
      <div class="col-span-full text-center py-20 bg-surface/30 rounded-3xl border border-white/5">
        <i class="fa-solid fa-users-slash text-gray-700 text-5xl mb-4"></i>
        <h3 class="text-xl font-bold text-white mb-2">Aucun expert trouvé</h3>
        <p class="text-subtext mb-8">Essayez de modifier vos critères de recherche.</p>
        <button (click)="resetFilters()"
          class="px-6 py-2.5 bg-white/5 hover:bg-white/10 border border-white/10 text-white rounded-full font-semibold uppercase tracking-widest text-[11px] transition-all">
          Réinitialiser
        </button>
      </div>
      }
    </div>

    <div class="mt-16 text-center">
      <button (click)="onShowAllExperts()"
        class="px-8 py-2.5 bg-primary hover:bg-primary-hover text-white rounded-full font-semibold uppercase tracking-widest text-[11px] shadow-[0_0_20px_-5px_rgba(236,72,153,0.5)] transition-all">
        Show all Experts
      </button>
    </div>
    }
  </div>
</section>
